<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="HandheldFriendly" content="true">

	  <!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155758577-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	  gtag('config', 'UA-155758577-1');
	</script>
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>{{ _('Carculator : Results') }}</title>
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/icon" href="/static/images/logo_icon.ico"/>
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" rel="stylesheet">
    <!-- Line icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.css">
    <!-- Bootstrap -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Slick slider -->
    <link href="/static/css/slick.css" rel="stylesheet">
    <!-- Gallery Lightbox -->
    <link href="/static/css/magnific-popup.css" rel="stylesheet">
    <!-- Theme color -->
    <link id="switcher" href="/static/css/theme-color/default-theme.css" rel="stylesheet">
	  <!-- Source Code pro font -->
	  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <!-- Main Style -->
    <link href="/static/css/style.css" rel="stylesheet">
	  <!-- NVD3 Style -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.css" rel="stylesheet">
	  <!-- Alternative to Meta Pro -->
	  <link href="https://fonts.googleapis.com/css?family=Fira+Sans&display=swap" rel="stylesheet">
	  <!-- Alternative to Georgia -->
	  <link href="https://fonts.googleapis.com/css?family=Neuton:300&display=swap" rel="stylesheet">




	<!-- NoUISlider -->

	<!-- Animate.css -->
  	<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css" rel="stylesheet">
	    <!-- Tool page Style -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.13.0/pivot.min.css">
    <link rel="stylesheet" href="/static/css/result_style.css">

    <!-- Fonts -->

    <!-- Open Sans for body font -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,600,700,800" rel="stylesheet">
    <!-- Montserrat for Title -->
  	<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>

    <![endif]-->
  </head>
  <body>

  	<!-- Start Header -->
	<header id="mu-header" class="mu-fixed-nav" role="banner">
		<div class="container" style="width:100%;">
			<nav class="navbar navbar-default mu-navbar">
                <div class="container" style="width:100%;text-align:center;">
					<!-- Image Logo -->
					  <a class="navbar-brand" href="#"><img src="/static/images/mediumsmall.png" style="height:40px;float:left;"></a>

					{% if current_user.is_anonymous %}

						<form action="{{ url_for('login') }}" style="display:inline-block;float:right;margin-top:5px;">
							<button class="online-button"
									style="float:right;margin:5px;background-color:transparent;color:white;border:1px solid white;
									display:inline-block;margin: 0 auto !important;">{{ _('Login') }}</button>
						  </form>

					{% else %}


						<form action="{{ url_for('logout') }}" style="display:inline-block;float:right;margin-top:5px;">
						<button class="online-button"
								style="margin:5px;background-color:transparent;color:white;border:1px solid white;
								display:inline-block;margin: 0 auto !important;float:right;">{{ _('Logout') }}</button>
					  </form>
					<h4 style="color:white;display:inline-block;float:right;margin-right:10px;font-family:inherit;font-weight:500;line-height:1.1;margin-top:10px;"> {{ current_user.username }}</h4>
					<i class="icon-user" style="color:white;font-size:20px;float:right;display:inline-block;margin-right:10px;margin-top:10px;margin-left:10px;"></i>

					{% endif %}

					<button class="online-button"
								style="float:right;margin-left:5px;margin-right:5px;margin-top:5px;background-color:transparent;color:white;border:1px solid white;"
								onclick=" window.open('https://carculator.readthedocs.io/en/latest/modeling.html', '_blank'); return false;">{{ _('Modeling and assumptions') }}
					</button>

					<!--<form action="/get_inventory_excel_for_bw" style="display:inline-block;float:right;">
							<button class="online-button"
									style="float:right;margin:5px;background-color:transparent;color:white;border:1px solid white;">{{ _('Export Brightway2-compatible inventories') }}</button>
					</form>-->

					<div class="dropdown">
					  <button class="online-button" onclick="dropdown_function()"
							  style="float:right;margin:5px;background-color:transparent;color:white;border:1px solid white;">
						  {{ _('Export Brightway2-compatible inventories') }}
					  </button>
					  <div id="export_dropdown" class="dropdown-content">
						<a href="/get_inventory_excel_for_bw/True/3.5">{{_("for ")}} ecoinvent 3.5 cutoff</a>
						<a href="/get_inventory_excel_for_bw/True/3.6">{{_("for ")}} ecoinvent 3.6 cutoff</a>
						<a href="/get_inventory_excel_for_bw/False/3.5">{{_("for ")}} REMIND-ecoinvent 3.5 cutoff</a>
						<a href="/get_inventory_excel_for_bw/False/3.6">{{_("for ")}} REMIND-ecoinvent 3.5 cutoff</a>
					  </div>
					</div>

					 <button class="online-button" onclick="share_results()"
						  style="float:right;margin:5px;background-color:transparent;color:white;border:1px solid white;display:inline-block;">{{ _('Share results') }}
					 </button>
			</div>
		</nav>
		</div>
	</header>
	<!-- End Header -->

    <main role="main">
		<!-- Start SCOPE -->
        <section id="mu-about">
			<div class="container" style="width:90%;">
				<div class="row">
                    <div class="top-row-result">

					    <div class="mu-about-header">
						<h2 class="mu-heading-title">{{ _('RESULTS') }}</h2>
							<span class="mu-header-dot"></span>

						<p>{{ _("The different sections of this page present the results of your analysis, based on the
							concept of life cycle assessment. Each relevant phase of the life cycle of the vehicle is considered
							and characterized against environmental and economic indicators.") }}</p>
						<p>{{ _("This is a useful tool when comparing technologies that have environmental hotspots
							at different phases of the life cycle of a vehicle.") }}</p>
					</div>
                    </div>
				</div>
            	</div>
        </section>

		<!-- Start SCOPE -->
        <section id="mu-about">
			<div class="container" style="width:90%;">
				<div class="row">

					<h2><img class="image" src="/static/images/book_icon.png"
												  style="height:70px; width:90px; border-right:3px solid rgba(0,0,0,0.6);
														padding:15px;margin-bottom:0px;display:inline-block;"
												 alt="image">
						<span style="color:grey;">{{ _('REFERENCE') }}</span></h2>
				</div>
						<div class="mu-about-area" style="padding-top:20px;">
							<div class="col-md-12">
								<p style="border:2px solid grey;padding:15px;width:100%;">{{ _('Any use of the results or inventories under any form should be referenced as following:') }}

								<br>
								<br><b>carculator: an open-source tool for prospective environmental and economic life cycle assessment of vehicles. When, Where and How can battery-electric vehicles help reduce greenhouse gas emissions?</b> <i>(in review)</i>
								<br>Sacchi R., Bauer C., Cox B., Mutel C.
									<br>Submitted to Renewable and Sustainable Energy Reviews. In review. <a target='_blank' href="https://www.psi.ch/en/media/57994/download"><u>Article (PDF)</u></a>.
								<br>
								<br><i>carculator online (1.0.4), carculator (1.0.8)</i>
								</p>
							</div>
                		</div>
            	</div>
        </section>



		<section id="mu-about">
			<div class="container" style="width:90%;">
				<div class="row"  >
					<h2><img class="image" src="/static/images/co2_icon.png"
												  style="height:70px; width:90px; border-right:3px solid rgba(0,0,0,0.6);
														padding:15px;margin-bottom:0px;display:inline-block;"
												 alt="image">
						<span style="color:grey;">{{ _('LIFE CYCLE IMPACT ASSESSMENT') }}</span></h2>
				</div>
						<div class="mu-about-area" style="padding-top:20px;">
							<div class="col-md-12">
								<p>{{ _("By default, the chart below shows the environmental impacts in terms of
									greenhouse gas emissions emitted for each vehicle, per km driven. The results are sub-divided
									into categories: powertrain, maintenance, fuel manufacture, energy storage, etc.
									The user can change the environmental indicator under the dropdown menu impact category.
									It is also possible to visualize the results as a table or other sorts of chart by using the
									dropdown menu located in the top-left corner of the chart area.") }}</p>
								<div id="chart_impacts" style="margin:5px auto;overflow:auto;"></div>
							</div>
                		</div>
            </div>
        </section>
		<!-- Start SCOPE -->
		<section id="mu-about" style="background-color:#f2f2f2;">
			<div class="container" style="width:90%;">
				<div class="row">
					<h2><img class="image" src="/static/images/cost_icon_grey.png"
												  style="height:70px; width:80px; border-right:3px solid grey;
														padding:15px;margin-bottom:0px;display:inline-block;"
												 alt="image">
						<span style="color:grey;">{{ _('LIFE CYCLE COST ASSESSMENT') }}</span></h2>
				</div>
					<div class="mu-about-area" style="padding-top:20px;">
						<div class="col-md-12">
							<p>{{ _("The chart below represents the cost of ownership per kilometer driven for each vehicle.
								It considers future electricity and fuel prices, as well as the amortization of the
								vehicle purchase over time.") }}</p>
							<div id="chart_costs" style="margin:5px auto;overflow:auto;"></div>
						</div>
                	</div>
			</div>
        </section>

		<section id="mu-about" style="background-color:#cccccc;">
			<div class="container" style="width:90%;">
				<div class="row">
					<h2><img class="image" src="/static/images/scale_icon.png"
												  style="height:70px; width:90px; border-right:3px solid white;
														padding:15px;margin-bottom:0px;display:inline-block;"
												 alt="image">
						<span style="color:white;">{{ _('BENCHMARK') }}</span></h2>
				</div>
				<div class="mu-about-area" style="padding-top:20px;">
					<div class="col-md-12">
						<p style="color:white;">{{ _("This section compares the distance that can be driven by each vehicle
							given a life cycle budget.") }}</p>
						<h3 style="color:white;">{{ _("How long can the vehicles drive on a life cycle budget of 1") }}
							<select id="select_benchmark" style="color:grey;">
								<option value="climate change">{{ _("kg CO2-eq.") }}</option>
								<option value="cost">{{ _("Euro") }}</option>
								<option value="fossil depletion">{{ _("liter of petrol-eq.") }}</option>
							</select> ?</h3>
						<table class="table" id="table_benchmark">
							<tbody>
							</tbody>
						</table>

					</div>
				</div>
            </div>
        </section>

		<section id="mu-about" style="background-color:grey;">
			<div class="container" style="width:90%;">
				<div class="row">
					<h2><img class="image" src="/static/images/odometer_icon.png"
												  style="height:70px; width:80px; border-right:3px solid white;
														padding:15px;margin-bottom:0px;display:inline-block;"
												 alt="image">
						<span style="color:white;">{{ _('OTHER INDICATORS') }}</span></h2>
				</div>
					<div class="mu-about-area" style="padding-top:20px;">
						<div class="table-responsive">
							<table class="table" style="color:white;">
								<tbody>
									<tr>
										<th class="col-md-6">
											<h3>{{ _('Tank-to-Wheel cumulated energy consumption along driving cycle') }}</h3>

										</th>
										<th class="col-md-6">
											<h3>{{ _('GHG emissions vs. ownership costs') }}</h3>

										</th>

									</tr>
									<tr>
										<td>
											<p>{{ _("The graph below shows the accumulated Tank-to-wheel energy required to perform the driving cycle.
													That is the energy required in the fuel tank of the vehicle to drive a given distance, including
													energy losses at different levels (due to engine efficiency, gearbox inefficiency, charge and discharge
													efficiency of the battery, etc.).
													Note that electric vehicles, such as battery electric vehicles or fuel cell vehicles, can partly recover
													the energy released during braking, which explains the downward sections of their slope.") }}</p>
										</td>
										<td>
											<p>{{ _("The graph below illustrates trade-off between environmental performance (in terms of greenhouse gas
												emissions) and cost of acquisition and use.") }}</p>
										</td>

									</tr>
									<tr>
										<td>
											<div>

												<svg id="chart-ttw-energy"
											   		style="width:40vw;height:30vw;font-size:16px;color:grey;margin-bottom:20px;">
												</svg>
											</div>
										</td>
										<td>
											<div>
												<svg id="chart-scatter"
											   		style="width:40vw;height:30vw; font-size:16px; color:grey;margin-bottom:20px;">
												</svg>

											</div>
										</td>

									</tr>
									<tr>
										<th class="col-md-6">
											<h3>{{ _('Accumulated impacts over lifetime') }}</h3>
										</th>
									</tr>
									<tr>
										<td>
											<p>{{ _("The graph below illustrates the accumulated impacts of the vehicles along their use phase.
												The intercept of the slope represents the impacts associated with the production of the vehicle, occurring
												before the use phase, while the slope illustrates variable emissions associated with the preparation of the fuel
												(or generation of the electricity) and direct exhaust and non-exhaust emissions. You may select an impact
												category to consider from the dropdown menu below.") }}</p>
											<select id='select_impact' style='color:grey;'>
														<option value='agricultural land occupation'>{{ _('Occupation of arable land [m2/year]') }}</option>
														<option value='climate change'>{{ _('Climate change [kg CO2-eq.]') }}</option>
														<option value='fossil depletion'>{{ _('Depletion of fossil energy resources [kg oil-eq.]') }}</option>
														<option value='freshwater ecotoxicity'>{{ _('Toxicity of non-marine aquatic environments [kg 1,4-DC-eq.]') }}</option>
														<option value='freshwater eutrophication'>{{ _('Eutrophication of non-marine aquatic environments [kg P-eq.]') }}</option>
														<option value='human toxicity'>{{ _('Human toxicity [kg 1,4-DC-eq.]') }}</option>
														<option value='ionizing radiation'>{{ _('Ionizing radiation [kg U235-Eq]') }}</option>
														<option value='marine ecotoxicity'>{{ _('Toxicity of marine aquatic environments [kg 1,4-DC-eq.]') }}</option>
														<option value='marine eutrophication'>{{ _('Eutrophication of non-marine aquatic environments [kg N-eq.]') }}</option>
														<option value='metal depletion'>{{ _('Depletion of metal resources [kg iron-eq.]') }}</option>
														<option value='natural land transformation'>{{ _('Natural land transformation [m2]') }}</option>
														<option value='ozone depletion'>{{ _('Deterioration of the ozone layer [kg CFC-11-eq.]') }}</option>
														<option value='particulate matter formation'>{{ _('Formation of fine particles [kg PM10-eq.]') }}</option>
														<option value='photochemical oxidant formation'>{{ _('Smog formation [kg NMVOC-eq.]') }}</option>
														<option value='terrestrial acidification'>{{ _('Terrestrial acidification [kg SO2-Eq-eq.]') }}</option>
														<option value='terrestrial ecotoxicity'>{{ _('Terrestrial toxicity [kg 1,4-DC.-eq.]') }}</option>
														<option value='urban land occupation'>{{ _('Land occupation in an urban environment [m2 / year]') }}</option>
														<option value='water depletion'>{{ _('Depletion of fresh water reserves [m3]') }}</option>
														<option value='human noise'>{{ _('Noise emissions [Person-Pascal/second]') }}</option>
														<option value='primary energy, renewable'>{{ _('Primary energy, renewable [Megajoule]') }}</option>
														<option value='primary energy, non-renewable'>{{ _('Primary energy, non-renewable [Megajoule]') }}</option>
											</select>
										</td>
									</tr>
									<tr>
										<td>
											<div>
												<svg id="chart-accumulated"
											   		style="width:40vw;height:30vw; font-size:16px; color:grey;margin-bottom:20px;">
												</svg>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
                	</div>
				</div>
        </section>
	</main>

	<!-- Start footer -->
	<footer id="mu-footer" role="contentinfo">
			<div class="container" style="width:100%;">
				<div class="row" style="width:100%;margin-top:25px;">
				  <div class="column" style="width:20%;float:left;text-align:center;">
					  <img src="/static/images/psi_logo.svg" style="height:50px;">
				  </div>
				  <div class="column" style="width:60%;display: inline-block;">
					  <div class="mu-footer-area">
						  <p>&copy; {{ _('Copyright') }} <a rel="nofollow" href="http://www.psi.ch">{{ _('Paul Scherrer Institut') }}</a>.
							  {{ _('All rights reserved') }}.</p>
					  </div>
				  </div>
				  <div class="column" style="width:20%;float: right;text-align:center;">
					  <img src="/static/images/ecoinvent_logo.png" style="height:50px;">
				  </div>
				</div>
			</div>
	</footer>

	<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
	<script src="https://cdn.plot.ly/plotly-basic-latest.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.22.0/pivot.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.22.0/plotly_renderers.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.6.0/tips_data.min.js"></script>
  	<script
	  src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
	  integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
	  crossorigin="anonymous"></script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap-notify@3.1.3/bootstrap-notify.min.js"></script>
	<script type="text/javascript" src="/static/js/i18n.js"></script>
	<script type="text/javascript" src="/static/js/result_page.js"></script>
	<!-- D3.js -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.min.js"></script>
	<!-- NVD3.js -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.js"></script>

	<script>


    var data = {{data|safe}};
    console.log(data);

    var lang_data = data[0]

    $.when($.ajax({
                url: "/language_result_display/"+lang_data,
                dataType: 'json',
                type: 'GET',
                success : function(data) {
                   var json = data
                    return json
                    },
                error: function(xhr, status, error){console.log(error) }})
     ).done(function(j){

     	//  Load the JSON File
		var name_default_impact;
		var chart_title;
		var chart_title_cost;
		$.when($.ajax({
					url: "/get_language",
					dataType: 'json',
					type: 'GET',
					success : function(data) {
					   var json = data
						return json
						},
					error: function(xhr, status, error){console.log(error) }})
				).done(function(json){
					i18n.translator.add(json);
					console.log(json);

					// Generate LCIA chart
					name_default_impact = i18n("climate change");
					chart_title = i18n("chart_title");
					generate_chart_impacts(data[1], chart_title, name_default_impact);

					// Generate LCC chart
					chart_title_cost = i18n("chart_title_cost");
					generate_chart_costs(data[2], chart_title_cost);

					// Generate benchmarks
					generate_benchmark(data[3], "climate change");

					// Generate line chart TtW energy
					generate_line_chart_TtW_energy(data[4]);

					// Generate scatter chart
					generate_scatter_chart(data[5]);

					// Generate chart accumulated impacts
					$("#select_impact").val('climate change')
					generate_chart_accumulated_impacts(data[6], i18n("climate change"), "climate change");

				});
            });


    $('#select_benchmark').on('change', function() {
	  generate_benchmark(data[3], this.value);
	});
	$('#select_impact').on('change', function() {
	  generate_chart_accumulated_impacts(data[6], i18n(this.value), this.value);
	});

	function dropdown_function(){
		document.getElementById("export_dropdown").classList.toggle("show");
	}
	// Close the dropdown if the user clicks outside of it
	window.onclick = function(event) {
	  if (!event.target.matches('.dropbtn')) {
		var dropdowns = document.getElementsByClassName("dropdown-content");
		var i;
		for (i = 0; i < dropdowns.length; i++) {
		  var openDropdown = dropdowns[i];
		  if (openDropdown.classList.contains('show')) {
			openDropdown.classList.remove('show');
		  }
		}
	  }
	}



</script>


</body>
</html>
